import{j as e,C as t,a as s,L as a,P as n,b as i,B as r,A as l,p as c,c as o,d,i as h,e as m,D as u,f as g}from"./chart-vendor-DixoPT4C.js";import{a as p,r as x,u as j,L as v,R as y,b as f,N,c as b,d as w,B as S}from"./react-vendor-CHj-VKtl.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var C={},I=p;C.createRoot=I.createRoot,C.hydrateRoot=I.hydrateRoot;const D=window.location.hostname.includes("railway.app")||window.location.hostname.includes("up.railway.app")?`${window.location.origin}/api`:"http://localhost:8000/api";const k=new class{constructor(){this.baseURL=D}async request(e,t={}){const s=`${this.baseURL}${e}`,a={headers:{"Content-Type":"application/json",...t.headers},...t};a.body&&"object"==typeof a.body&&(a.body=JSON.stringify(a.body));try{const e=await fetch(s,a);let t;const n=e.headers.get("content-type");if(!n||!n.includes("application/json")){await e.text();throw new Error(`Server returned non-JSON: ${e.status} ${e.statusText}`)}if(t=await e.json(),!e.ok)throw new Error(t.error||t.detail||t.message||`Request failed: ${e.status} ${e.statusText}`);return t}catch(n){throw n}}async register(e,t){return this.request("/users/register/",{method:"POST",body:{email:e,password:t}})}async login(e,t){return this.request("/users/login/",{method:"POST",body:{email:e,password:t}})}async getTransactions(e){return this.request(`/transactions/?user_id=${e}`)}async createTransaction(e,t){return this.request("/transactions/",{method:"POST",body:{user_id:e,...t}})}async deleteTransaction(e){return this.request(`/transactions/${e}/`,{method:"DELETE"})}async getSettings(e){const t=await this.request(`/settings/?user_id=${e}`);return t.length>0?t[0]:null}async updateSettings(e,t){return this.request(`/settings/${e}/`,{method:"PUT",body:t})}async createSettings(e,t){return this.request("/settings/",{method:"POST",body:{user_id:e,...t}})}async getGoals(e){return this.request(`/goals/?user_id=${e}`)}async createGoal(e,t){return this.request("/goals/",{method:"POST",body:{user_id:e,...t}})}async updateGoal(e,t){return this.request(`/goals/${e}/`,{method:"PUT",body:t})}async deleteGoal(e){return this.request(`/goals/${e}/`,{method:"DELETE"})}async getAnalytics(e,t="all"){return this.request(`/analytics/${e}/?period=${t}`)}async getInsights(e){return this.request(`/insights/${e}/`)}async getCategories(e){return this.request(`/categories/?user_id=${e}`)}async createCategory(e,t){return this.request("/categories/",{method:"POST",body:{user_id:e,...t}})}async updateCategory(e,t){return this.request(`/categories/${e}/`,{method:"PUT",body:t})}async deleteCategory(e){return this.request(`/categories/${e}/`,{method:"DELETE"})}async getGoalCalculations(e){return this.request(`/goals/${e}/calculations/`)}},_=x.createContext(null);function M({children:t}){const[s,a]=x.useState(null),[n,i]=x.useState(!0);x.useEffect(()=>{const e=localStorage.getItem("finance_user");if(e)try{a(JSON.parse(e))}catch(t){localStorage.removeItem("finance_user")}i(!1)},[]);return e.jsx(_.Provider,{value:{user:s,loading:n,login:async(e,t)=>{try{const s=await k.login(e,t);return localStorage.setItem("finance_user",JSON.stringify(s)),a(s),s}catch(s){const t={id:Date.now().toString(),email:e,name:e.split("@")[0]};return localStorage.setItem("finance_user",JSON.stringify(t)),a(t),t}},register:async(e,t)=>{try{const s=await k.register(e,t);if(!s||!s.id)throw new Error("Invalid response from server");return localStorage.setItem("finance_user",JSON.stringify(s)),a(s),s}catch(s){const t={id:Date.now().toString(),email:e,name:e.split("@")[0]};return localStorage.setItem("finance_user",JSON.stringify(t)),a(t),t}},logout:()=>{localStorage.removeItem("finance_user"),a(null)}},children:t})}function T(){const e=x.useContext(_);if(!e)throw new Error("useAuth must be used within AuthProvider");return e}function A(){const[t,s]=x.useState("login"),[a,n]=x.useState(""),[i,r]=x.useState(""),[l,c]=x.useState(""),[o,d]=x.useState(""),[h,m]=x.useState(""),[u,g]=x.useState(!1),{login:p,register:v}=T(),y=j();return e.jsx("div",{className:"auth-container",children:e.jsxs("div",{className:"auth-card",children:[e.jsxs("div",{className:"auth-header",children:[e.jsx("h1",{className:"auth-title",children:"üí∞ –£—á—ë—Ç –†–∞—Å—Ö–æ–¥–æ–≤"}),e.jsx("p",{className:"auth-subtitle",children:"–ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–π—Ç–µ —Å–≤–æ–∏ —Ñ–∏–Ω–∞–Ω—Å—ã"})]}),e.jsxs("div",{className:"auth-tabs",children:[e.jsx("button",{className:"auth-tab "+("login"===t?"active":""),onClick:()=>{s("login"),d(""),m("")},children:"–í—Ö–æ–¥"}),e.jsx("button",{className:"auth-tab "+("register"===t?"active":""),onClick:()=>{s("register"),d(""),m("")},children:"–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è"})]}),"login"===t?e.jsxs("form",{onSubmit:async e=>{e.preventDefault(),d(""),g(!0);try{if(!a||!i)return d("–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è"),void g(!1);if(i.length<6)return d("–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –º–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤"),void g(!1);await p(a,i),y("/")}catch(t){d(t.message||"–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞")}finally{g(!1)}},className:"auth-form active",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Email"}),e.jsx("input",{type:"email",className:"form-input",placeholder:"your@email.com",value:a,onChange:e=>n(e.target.value),required:!0,autoComplete:"email"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"–ü–∞—Ä–æ–ª—å"}),e.jsx("input",{type:"password",className:"form-input",placeholder:"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢",value:i,onChange:e=>r(e.target.value),required:!0,minLength:6,autoComplete:"current-password"})]}),e.jsx("button",{type:"submit",className:"btn btn-primary btn-full",disabled:u,children:u?"–í—Ö–æ–¥...":"–í–æ–π—Ç–∏"}),o&&e.jsx("div",{className:"error-message",children:o})]}):e.jsxs("form",{onSubmit:async e=>{e.preventDefault(),d(""),m(""),g(!0);try{if(!a||!i||!l)return d("–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è"),void g(!1);if(i.length<6)return d("–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –º–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤"),void g(!1);if(i!==l)return d("–ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç"),void g(!1);await v(a,i),m("–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞!"),setTimeout(()=>y("/onboarding"),1e3)}catch(t){d(t.message||"–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏")}finally{g(!1)}},className:"auth-form",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Email"}),e.jsx("input",{type:"email",className:"form-input",placeholder:"your@email.com",value:a,onChange:e=>n(e.target.value),required:!0,autoComplete:"email"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"–ü–∞—Ä–æ–ª—å"}),e.jsx("input",{type:"password",className:"form-input",placeholder:"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢",value:i,onChange:e=>r(e.target.value),required:!0,minLength:6,autoComplete:"new-password"}),e.jsx("small",{className:"form-hint",children:"–ú–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å"}),e.jsx("input",{type:"password",className:"form-input",placeholder:"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢",value:l,onChange:e=>c(e.target.value),required:!0,minLength:6,autoComplete:"new-password"})]}),e.jsx("button",{type:"submit",className:"btn btn-primary btn-full",disabled:u,children:u?"–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è...":"–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è"}),o&&e.jsx("div",{className:"error-message",children:o}),h&&e.jsx("div",{className:"success-message",children:h})]}),e.jsx("div",{className:"auth-footer",children:e.jsx("p",{children:"–ë–µ—Å–ø–ª–∞—Ç–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —É—á—ë—Ç–∞ —Ä–∞—Å—Ö–æ–¥–æ–≤"})})]})})}class P{constructor(){this.userId=this.getUserId(),this.useAPI=!0}getUserId(){const e=localStorage.getItem("finance_user");return e?JSON.parse(e).id:null}getKey(e){return`finance_${this.userId}_${e}`}async getTransactions(){if(this.useAPI&&this.userId)try{const e=await k.getTransactions(this.userId);return Array.isArray(e)?e:[]}catch(s){this.useAPI=!1}const e=this.getKey("transactions"),t=localStorage.getItem(e);return t?JSON.parse(t):[]}async saveTransaction(e){if(this.useAPI&&this.userId)try{return await k.createTransaction(this.userId,{type:e.type,amount:e.amount.toString(),category:e.category||"",description:e.description||"",date:e.date})}catch(a){this.useAPI=!1}const t=await this.getTransactions(),s={...e,id:e.id||Date.now().toString(),timestamp:e.timestamp||Date.now()};return t.push(s),localStorage.setItem(this.getKey("transactions"),JSON.stringify(t)),s}async deleteTransaction(e){if(this.useAPI)try{return void(await k.deleteTransaction(e))}catch(s){this.useAPI=!1}const t=(await this.getTransactions()).filter(t=>t.id!==e);localStorage.setItem(this.getKey("transactions"),JSON.stringify(t))}async getUserSettings(){if(this.useAPI&&this.userId)try{const e=await k.getSettings(this.userId);if(e)return{monthlyIncome:parseFloat(e.monthly_income)||0,fixedExpenses:parseFloat(e.fixed_expenses)||0,financialGoal:e.financial_goal||"",budgets:e.budgets||{},onboardingCompleted:e.onboarding_completed||!1,id:e.id,userId:e.user}}catch(s){this.useAPI=!1}const e=this.getKey("settings"),t=localStorage.getItem(e);return t?JSON.parse(t):{monthlyIncome:0,fixedExpenses:0,financialGoal:"",budgets:{},onboardingCompleted:!1}}async saveUserSettings(e){if(this.useAPI&&this.userId)try{const t=await this.getUserSettings(),s={monthly_income:e.monthlyIncome||t.monthlyIncome,fixed_expenses:e.fixedExpenses||t.fixedExpenses,financial_goal:void 0!==e.financialGoal?e.financialGoal:t.financialGoal,budgets:void 0!==e.budgets?e.budgets:t.budgets,onboarding_completed:void 0!==e.onboardingCompleted?e.onboardingCompleted:t.onboardingCompleted};return t.id?await k.updateSettings(t.id,s):await k.createSettings(this.userId,s),await this.getUserSettings()}catch(s){this.useAPI=!1}const t={...await this.getUserSettings(),...e};return localStorage.setItem(this.getKey("settings"),JSON.stringify(t)),t}async completeOnboarding(e){const t={monthlyIncome:parseFloat(e.monthlyIncome)||0,fixedExpenses:parseFloat(e.fixedExpenses)||0,financialGoal:e.financialGoal||"",budgets:{},onboardingCompleted:!0};return this.saveUserSettings(t)}async hasCompletedOnboarding(){return!0===(await this.getUserSettings()).onboardingCompleted}async getGoals(){if(this.useAPI&&this.userId)try{return await k.getGoals(this.userId)}catch(s){this.useAPI=!1}const e=this.getKey("goals"),t=localStorage.getItem(e);return t?JSON.parse(t):[]}async saveGoal(e){if(this.useAPI&&this.userId)try{return e.id?await k.updateGoal(e.id,{title:e.title,description:e.description||"",target_amount:e.target_amount.toString(),current_amount:e.current_amount.toString(),deadline:e.deadline||null,status:e.status||"active"}):await k.createGoal(this.userId,{title:e.title,description:e.description||"",target_amount:e.target_amount.toString(),current_amount:e.current_amount||"0",deadline:e.deadline||null,status:"active"})}catch(s){this.useAPI=!1}const t=await this.getGoals();if(e.id){const s=t.findIndex(t=>t.id===e.id);s>=0&&(t[s]=e)}else e.id=Date.now().toString(),t.push(e);return localStorage.setItem(this.getKey("goals"),JSON.stringify(t)),e}async deleteGoal(e){if(this.useAPI)try{return void(await k.deleteGoal(e))}catch(s){this.useAPI=!1}const t=(await this.getGoals()).filter(t=>t.id!==e);localStorage.setItem(this.getKey("goals"),JSON.stringify(t))}async getCategories(){if(this.useAPI&&this.userId)try{return await k.getCategories(this.userId)}catch(s){this.useAPI=!1}const e=this.getKey("categories"),t=localStorage.getItem(e);return t?JSON.parse(t):[]}async saveCategory(e){if(this.useAPI&&this.userId)try{return e.id?await k.updateCategory(e.id,{name:e.name}):await k.createCategory(this.userId,{name:e.name})}catch(s){this.useAPI=!1}const t=await this.getCategories();if(e.id){const s=t.findIndex(t=>t.id===e.id);s>=0&&(t[s]=e)}else e.id=Date.now().toString(),t.push(e);return localStorage.setItem(this.getKey("categories"),JSON.stringify(t)),e}async deleteCategory(e){if(this.useAPI)try{return void(await k.deleteCategory(e))}catch(s){this.useAPI=!1}const t=(await this.getCategories()).filter(t=>t.id!==e);localStorage.setItem(this.getKey("categories"),JSON.stringify(t))}async getGoalCalculations(e){if(this.useAPI)try{return await k.getGoalCalculations(e)}catch(t){return null}return null}}let E=null;function O(){return E||(E=new P),E}function F(){return e.jsx("footer",{className:"footer",children:e.jsxs("div",{className:"footer-content",children:[e.jsxs("div",{className:"footer-text",children:["Made by ",e.jsx("strong",{children:"Adams Midov"})]}),e.jsxs("div",{className:"footer-links",children:[e.jsxs("a",{href:"https://t.me/adamsmidov",target:"_blank",rel:"noopener noreferrer",className:"footer-link",title:"Telegram",children:[e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 0C5.373 0 0 5.373 0 12s5.373 12 12 12 12-5.373 12-12S18.627 0 12 0zm5.562 8.161c-.165 1.632-1.279 5.594-1.805 7.417-.223.799-.665 1.065-1.092 1.089-.917.048-1.614-.605-2.503-1.186-1.113-.729-1.743-1.131-2.823-1.811-1.256-.785-.442-1.217.274-1.924.188-.184 3.247-2.977 3.307-3.23.007-.032.014-.152-.057-.213-.071-.061-.176-.038-.253-.023-.107.024-1.793 1.139-5.062 3.345-.479.328-.913.488-1.302.48-.428-.008-1.252-.241-1.865-.44-.753-.244-1.349-.372-1.297-.785.027-.211.403-.428 1.109-.65 4.375-1.91 7.297-3.168 8.767-3.774 4.139-1.756 4.996-2.061 5.558-2.08.126-.004.408.03.591.183.155.129.198.303.219.423.02.12.045.394.025.606z"})}),"Telegram"]}),e.jsxs("a",{href:"https://github.com/adamsmidov",target:"_blank",rel:"noopener noreferrer",className:"footer-link",title:"GitHub",children:[e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"})}),"GitHub"]})]})]})})}function R(){const[t,s]=x.useState(""),[a,n]=x.useState(""),[i,r]=x.useState(""),[l,c]=x.useState(!1),o=j();return e.jsxs("div",{className:"container",style:{maxWidth:"600px"},children:[e.jsxs("div",{className:"onboarding-container",children:[e.jsxs("div",{className:"onboarding-header",children:[e.jsx("h1",{className:"onboarding-title",children:"–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!"}),e.jsx("p",{className:"onboarding-subtitle",children:"–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø—Ä–æ—Ñ–∏–ª—å –∑–∞ 2 –º–∏–Ω—É—Ç—ã –∏ –ø–æ–ª—É—á–∏—Ç–µ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –∏–Ω—Å–∞–π—Ç—ã"})]}),e.jsxs("form",{onSubmit:async e=>{e.preventDefault(),c(!0);try{if(!t||!a)return alert("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è"),void c(!1);const e=O();await e.completeOnboarding({monthlyIncome:t,fixedExpenses:a,financialGoal:i}),o("/")}catch(s){alert("–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö: "+(s.message||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞"))}finally{c(!1)}},className:"onboarding-form",children:[e.jsxs("div",{className:"form-section",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"–í–∞—à –¥–æ—Ö–æ–¥ –≤ –º–µ—Å—è—Ü (—Å—É–º)"}),e.jsx("input",{type:"number",className:"form-input",placeholder:"5000000",step:"1000",min:"0",value:t,onChange:e=>s(e.target.value),required:!0}),e.jsx("p",{className:"form-hint",children:"–°—Ä–µ–¥–Ω–∏–π –¥–æ—Ö–æ–¥ –∑–∞ –º–µ—Å—è—Ü"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã –≤ –º–µ—Å—è—Ü (—Å—É–º)"}),e.jsx("input",{type:"number",className:"form-input",placeholder:"2000000",step:"1000",min:"0",value:a,onChange:e=>n(e.target.value),required:!0}),e.jsx("p",{className:"form-hint",children:"–ê—Ä–µ–Ω–¥–∞, –∫–æ–º–º—É–Ω–∞–ª—å–Ω—ã–µ, –∫—Ä–µ–¥–∏—Ç—ã –∏ —Ç.–¥."})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"–§–∏–Ω–∞–Ω—Å–æ–≤–∞—è —Ü–µ–ª—å (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)"}),e.jsx("input",{type:"text",className:"form-input",placeholder:"–ù–∞–∫–æ–ø–∏—Ç—å –Ω–∞ –æ—Ç–ø—É—Å–∫",value:i,onChange:e=>r(e.target.value)}),e.jsx("p",{className:"form-hint",children:"–ù–∞ —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –Ω–∞–∫–æ–ø–∏—Ç—å?"})]})]}),e.jsx("div",{className:"onboarding-actions",children:e.jsx("button",{type:"submit",className:"btn btn-primary btn-full",disabled:l,children:l?"–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ...":"–ù–∞—á–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å"})})]})]}),e.jsx(F,{})]})}class ${constructor(e,t){this.transactions=e||[],this.userSettings=t||{},this.now=new Date}getDailySpendingLimit(){const e=this.userSettings.monthlyIncome||0,t=this.userSettings.fixedExpenses||0,s=new Date(this.now.getFullYear(),this.now.getMonth()+1,0).getDate(),a=s-this.now.getDate()+1,n=e-t,i=n/s,r=n-this.getCurrentMonthSpending(),l=r/a,c={monthlyIncome:e,fixedExpenses:t,availableForMonth:n,daysInMonth:s,dailyLimit:i,currentSpending:this.getCurrentMonthSpending(),remainingForMonth:r,daysRemaining:a};return{dailyLimit:Math.max(0,i),dailyRemaining:Math.max(0,l),remainingForMonth:Math.max(0,r),daysRemaining:a,formula:c}}getCurrentMonthSpending(){const e=new Date(this.now.getFullYear(),this.now.getMonth(),1),t=new Date(this.now.getFullYear(),this.now.getMonth()+1,0,23,59,59);return this.transactions.filter(e=>"expense"===e.type).filter(s=>{const a=new Date(s.date+"T00:00:00");return a>=e&&a<=t}).reduce((e,t)=>e+(t.amount||0),0)}getPreviousMonthSpending(){const e=new Date(this.now.getFullYear(),this.now.getMonth()-1,1),t=new Date(this.now.getFullYear(),this.now.getMonth(),0,23,59,59);return this.transactions.filter(e=>"expense"===e.type).filter(s=>{const a=new Date(s.date+"T00:00:00");return a>=e&&a<=t}).reduce((e,t)=>e+(t.amount||0),0)}getPeriodComparison(){const e=this.getCurrentMonthSpending(),t=this.getPreviousMonthSpending(),s=e-t,a=t>0?s/t*100:0;return{current:e,previous:t,difference:s,percentage:Math.round(a),trend:s>0?"up":s<0?"down":"same"}}getMonthEndForecast(){const e=this.userSettings.monthlyIncome||0,t=this.userSettings.fixedExpenses||0,s=this.getCurrentMonthSpending(),a=new Date(this.now.getFullYear(),this.now.getMonth()+1,0).getDate(),n=this.now.getDate(),i=s/Math.max(n,1),r=a-n,l=s+i*r,c=e-t-l,o=e-t-1.2*l;return{forecastBalance:Math.round(c),projectedSpending:Math.round(l),worstCaseBalance:Math.round(o),currentSpending:s,monthlyIncome:e,fixedExpenses:t,daysRemaining:r,avgDailySpending:Math.round(i),scenario:c>0?"positive":c<-5e4?"negative":"warning"}}getCategoryOverspending(e){if(!e||0===Object.keys(e).length)return[];const t=new Date(this.now.getFullYear(),this.now.getMonth(),1),s=new Date(this.now.getFullYear(),this.now.getMonth()+1,0,23,59,59),a={};return this.transactions.filter(e=>"expense"===e.type).filter(e=>{const a=new Date(e.date+"T00:00:00");return a>=t&&a<=s}).forEach(e=>{const t=e.category||"–î—Ä—É–≥–æ–µ";a[t]=(a[t]||0)+(e.amount||0)}),Object.keys(e).map(t=>{const s=a[t]||0,n=e[t],i=n-s,r=n>0?s/n*100:0;return{category:t,spent:Math.round(s),budget:Math.round(n),remaining:Math.round(i),percentage:Math.round(r),status:r>=100?"over":r>=80?"warning":"ok"}}).filter(e=>"ok"!==e.status).sort((e,t)=>t.percentage-e.percentage)}getSpendingStreak(){const e=new Date(this.now);e.setHours(0,0,0,0);const t=this.getDailySpendingLimit().dailyLimit;let s=0,a=new Date(e);for(;a>=new Date(this.now.getFullYear(),this.now.getMonth(),1);){if(!(this.transactions.filter(e=>{if("expense"!==e.type)return!1;const t=new Date(e.date+"T00:00:00");return t.setHours(0,0,0,0),t.getTime()===a.getTime()}).reduce((e,t)=>e+(t.amount||0),0)<=t))break;s++,a.setDate(a.getDate()-1)}return{days:s,isActive:s>0,message:s>7?"–û—Ç–ª–∏—á–Ω–∞—è –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∞! üî•":s>3?"–•–æ—Ä–æ—à–∞—è —Ä–∞–±–æ—Ç–∞!":"–ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ!"}}getTopSpendingInsights(){const e=new Date(this.now.getFullYear(),this.now.getMonth(),1),t=this.transactions.filter(t=>{if("expense"!==t.type)return!1;return new Date(t.date+"T00:00:00")>=e}),s={};t.forEach(e=>{const t=e.date||new Date(e.created_at).toISOString().split("T")[0];s[t]=(s[t]||0)+(e.amount||0)});const a=Object.entries(s).sort((e,t)=>t[1]-e[1])[0],n={};t.forEach(e=>{const t=e.category||"–î—Ä—É–≥–æ–µ";n[t]=(n[t]||0)+(e.amount||0)});const i=Object.entries(n).sort((e,t)=>t[1]-e[1])[0];return{topDay:a?{date:a[0],amount:a[1]}:null,topCategory:i?{name:i[0],amount:i[1]}:null}}getSavingsOpportunities(){const e=this.getTopSpendingInsights().topCategory;if(!e)return null;e.amount,this.now.getDate();const t=Math.round(.1*e.amount),s=Math.round(.2*e.amount);return{category:e.name,current:e.amount,ifReduce10:t,ifReduce20:s,message:`–ï—Å–ª–∏ —Å–æ–∫—Ä–∞—Ç–∏—Ç—å "${e.name}" –Ω–∞ 20%, —Å—ç–∫–æ–Ω–æ–º–∏—à—å ${this.formatAmount(s)}`}}getRecurringExpenses(){const e=this.transactions.filter(e=>{if("expense"!==e.type)return!1;return new Date(e.date+"T00:00:00")>=new Date(this.now.getFullYear(),this.now.getMonth(),1)}),t={};return e.forEach(e=>{const s=e.category||"–î—Ä—É–≥–æ–µ",a=1e3*Math.round(e.amount/1e3),n=`${s}_${a}`;t[n]||(t[n]={category:s,amount:a,count:0,total:0}),t[n].count++,t[n].total+=e.amount}),Object.values(t).filter(e=>e.count>=3).sort((e,t)=>t.count-e.count).slice(0,3)}getAutomaticInsights(){const e=[],t=this.getDailySpendingLimit(),s=this.getMonthEndForecast(),a=this.getPeriodComparison(),n=this.getTopSpendingInsights(),i=this.getSavingsOpportunities();return s.forecastBalance<0&&e.push({type:"warning",title:"‚ö†Ô∏è –†–∏—Å–∫ –ø–µ—Ä–µ—Ä–∞—Å—Ö–æ–¥–∞",message:`–ï—Å–ª–∏ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ —Ç—Ä–∞—Ç–∏—Ç—å —Ç–∞–∫ –∂–µ, –∫ –∫–æ–Ω—Ü—É –º–µ—Å—è—Ü–∞ –±—É–¥–µ—Ç–µ –¥–æ–ª–∂–Ω—ã ${this.formatAmount(Math.abs(s.forecastBalance))}`,priority:"high"}),"up"===a.trend&&a.percentage>15?e.push({type:"danger",title:"üìà –†–æ—Å—Ç —Ä–∞—Å—Ö–æ–¥–æ–≤",message:`–í—ã —Ç—Ä–∞—Ç–∏—Ç–µ –Ω–∞ ${a.percentage}% –±–æ–ª—å—à–µ, —á–µ–º –≤ –ø—Ä–æ—à–ª–æ–º –º–µ—Å—è—Ü–µ`,priority:"medium"}):"down"===a.trend&&a.percentage<-10&&e.push({type:"success",title:"üìâ –°–Ω–∏–∂–µ–Ω–∏–µ —Ä–∞—Å—Ö–æ–¥–æ–≤",message:`–û—Ç–ª–∏—á–Ω–æ! –í—ã —Ç—Ä–∞—Ç–∏—Ç–µ –Ω–∞ ${Math.abs(a.percentage)}% –º–µ–Ω—å—à–µ, —á–µ–º –≤ –ø—Ä–æ—à–ª–æ–º –º–µ—Å—è—Ü–µ`,priority:"low"}),n.topCategory&&e.push({type:"info",title:"üí∞ –°–∞–º–∞—è –∑–∞—Ç—Ä–∞—Ç–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è",message:`"${n.topCategory.name}" ‚Äî ${this.formatAmount(n.topCategory.amount)} –∑–∞ –º–µ—Å—è—Ü`,priority:"medium"}),i&&e.push({type:"opportunity",title:"üí° –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å—ç–∫–æ–Ω–æ–º–∏—Ç—å",message:i.message,priority:"medium"}),t.dailyRemaining<.3*t.dailyLimit&&e.push({type:"warning",title:"‚è∞ –õ–∏–º–∏—Ç –Ω–∞ –∏—Å—Ö–æ–¥–µ",message:`–°–µ–≥–æ–¥–Ω—è –º–æ–∂–Ω–æ –ø–æ—Ç—Ä–∞—Ç–∏—Ç—å —Ç–æ–ª—å–∫–æ ${this.formatAmount(t.dailyRemaining)}. –ë—É–¥—å—Ç–µ –æ—Å—Ç–æ—Ä–æ–∂–Ω—ã!`,priority:"high"}),e.sort((e,t)=>{const s={high:3,medium:2,low:1};return s[t.priority]-s[e.priority]})}formatAmount(e){return new Intl.NumberFormat("ru-RU").format(Math.round(e))+" —Å—É–º"}getAllInsights(e){return{dailyLimit:this.getDailySpendingLimit(),comparison:this.getPeriodComparison(),forecast:this.getMonthEndForecast(),overspending:this.getCategoryOverspending(e||{}),streak:this.getSpendingStreak(),topSpending:this.getTopSpendingInsights(),savingsOpportunities:this.getSavingsOpportunities(),recurringExpenses:this.getRecurringExpenses(),automaticInsights:this.getAutomaticInsights()}}}function L({transactions:t,userSettings:s,formatAmount:a,dataService:n}){const[i,r]=x.useState([]),[l,c]=x.useState(!0);x.useEffect(()=>{o()},[]);const o=async()=>{try{const e=await n.getGoals();Array.isArray(e)?r(e.filter(e=>e&&"active"===e.status)||[]):r([])}catch(e){r([])}finally{c(!1)}},d=(t||[]).filter(e=>e&&"expense"===e.type),h=(t||[]).filter(e=>e&&"income"===e.type),m=d.filter(e=>{if(!e||!e.date)return!1;try{const t=new Date(e.date),s=new Date;return t.getMonth()===s.getMonth()&&t.getFullYear()===s.getFullYear()}catch{return!1}}).reduce((e,t)=>e+(t.amount||0),0);h.filter(e=>{if(!e||!e.date)return!1;try{const t=new Date(e.date),s=new Date;return t.getMonth()===s.getMonth()&&t.getFullYear()===s.getFullYear()}catch{return!1}}).reduce((e,t)=>e+(t.amount||0),0);const u=s.monthlyIncome||0,g=s.fixedExpenses||0,p=u-g-m,j=new Date((new Date).getFullYear(),(new Date).getMonth()+1,0).getDate()-(new Date).getDate()+1,v=p>0&&j>0?p/j:0,y=p>0?p:0;return e.jsxs("div",{children:[e.jsxs("div",{className:"insight-card wow",children:[e.jsx("div",{className:"insight-header",children:e.jsx("span",{className:"insight-title",children:"üí∞ –î–æ—Å—Ç—É–ø–Ω–æ –¥–ª—è –æ—Ç–∫–ª–∞–¥—ã–≤–∞–Ω–∏—è"})}),e.jsxs("div",{className:"insight-message",children:[e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:"bold",marginBottom:"10px"},children:a(p)}),e.jsxs("div",{style:{fontSize:"0.9rem",color:"var(--text-secondary)"},children:["–î–æ—Ö–æ–¥: ",a(u)," - –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ: ",a(g)," - –¢–µ–∫—É—â–∏–µ —Ä–∞—Å—Ö–æ–¥—ã: ",a(m)]})]})]}),p>0?e.jsxs("div",{className:"insight-card wow",style:{marginTop:"20px"},children:[e.jsx("div",{className:"insight-header",children:e.jsx("span",{className:"insight-title",children:"üìÖ –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ –æ—Ç–∫–ª–∞–¥—ã–≤–∞–Ω–∏–µ"})}),e.jsxs("div",{className:"insight-message",children:[e.jsxs("div",{style:{marginBottom:"10px"},children:[e.jsx("strong",{children:"–í –¥–µ–Ω—å:"})," ",a(v)]}),e.jsxs("div",{children:[e.jsx("strong",{children:"–í –º–µ—Å—è—Ü:"})," ",a(y)]}),j>0&&e.jsxs("div",{style:{marginTop:"10px",fontSize:"0.85rem",color:"var(--text-secondary)"},children:["–û—Å—Ç–∞–ª–æ—Å—å –¥–Ω–µ–π –≤ –º–µ—Å—è—Ü–µ: ",j]})]})]}):e.jsxs("div",{className:"insight-card insight-danger wow",style:{marginTop:"20px"},children:[e.jsx("div",{className:"insight-header",children:e.jsx("span",{className:"insight-title",children:"‚ö†Ô∏è –ù–µ—Ç —Å—Ä–µ–¥—Å—Ç–≤ –¥–ª—è –æ—Ç–∫–ª–∞–¥—ã–≤–∞–Ω–∏—è"})}),e.jsx("div",{className:"insight-message",children:"–¢–µ–∫—É—â–∏–µ —Ä–∞—Å—Ö–æ–¥—ã –ø—Ä–µ–≤—ã—à–∞—é—Ç –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Å—Ä–µ–¥—Å—Ç–≤–∞. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Å–æ–∫—Ä–∞—Ç–∏—Ç—å —Ç—Ä–∞—Ç—ã."})]}),i.length>0&&e.jsxs("div",{style:{marginTop:"20px"},children:[e.jsx("h3",{className:"section-title",style:{fontSize:"1.1rem",marginBottom:"15px"},children:"–ü–æ –≤–∞—à–∏–º —Ü–µ–ª—è–º"}),i.map(t=>{if(!t||!t.id)return null;const s=(t.target_amount||0)-(t.current_amount||0);let n=30;if(t.deadline)try{n=Math.max(1,Math.ceil((new Date(t.deadline)-new Date)/864e5))}catch{n=30}const i=s>0&&n>0?Math.min(v,s/n):0;return e.jsxs("div",{className:"insight-card wow",style:{marginBottom:"15px"},children:[e.jsx("div",{className:"insight-header",children:e.jsx("span",{className:"insight-title",children:t.title||"–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è"})}),e.jsxs("div",{className:"insight-message",children:[e.jsxs("div",{children:["–û—Å—Ç–∞–ª–æ—Å—å: ",a(s)]}),t.deadline&&e.jsxs("div",{style:{fontSize:"0.85rem",color:"var(--text-secondary)",marginTop:"5px"},children:["–°—Ä–æ–∫: ",new Date(t.deadline).toLocaleDateString("ru-RU")]}),i>0&&e.jsxs("div",{style:{marginTop:"10px",fontWeight:"bold"},children:["–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –æ—Ç–∫–ª–∞–¥—ã–≤–∞—Ç—å: ",a(i)," –≤ –¥–µ–Ω—å"]})]})]},t.id)})]})]})}function q(){const{user:t,logout:s}=T(),a=j(),n=O(),[i,r]=x.useState([]),[l,c]=x.useState(null),[o,d]=x.useState(!0),[h,m]=x.useState(""),[u,g]=x.useState((new Date).toISOString().split("T")[0]),[p,y]=x.useState(""),[f,N]=x.useState("expense"),[b,w]=x.useState(""),[S,C]=x.useState(!1),[I,D]=x.useState(!1),[k,_]=x.useState([]),[M,A]=x.useState(!1),[P,E]=x.useState(""),[R,q]=x.useState(null),[G,B]=x.useState("transactions"),[z,U]=x.useState(1),[J,Y]=x.useState("all"),K=["–ü—Ä–æ–¥—É–∫—Ç—ã","–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç","–†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è","–ó–¥–æ—Ä–æ–≤—å–µ","–ö–æ–º–º—É–Ω–∞–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏","–û–¥–µ–∂–¥–∞","–î—Ä—É–≥–æ–µ"];x.useEffect(()=>{W(),H(),Z()},[]);const W=async()=>{await n.hasCompletedOnboarding()||a("/onboarding")},H=async()=>{d(!0);try{const e=await n.getTransactions();r(e.sort((e,t)=>{const s=e.created_at||e.timestamp||0,a=t.created_at||t.timestamp||0;return new Date(a)-new Date(s)}));const t=await n.getUserSettings();c(t)}catch(e){}finally{d(!1)}},Z=async()=>{try{const e=await n.getCategories(),t=[...K];Array.isArray(e)&&e.forEach(e=>{e&&e.name&&!t.includes(e.name)&&t.push(e.name)}),_(t)}catch(e){_(K)}},Q=e=>new Intl.NumberFormat("ru-RU").format(e)+" —Å—É–º",V=x.useMemo(()=>{let e=(i||[]).filter(e=>e&&(e.date||e.created_at));if("all"!==J){const t=new Date;"day"===J?t.setHours(0,0,0,0):"week"===J?t.setDate(t.getDate()-7):"month"===J&&t.setMonth(t.getMonth()-1),e=e.filter(e=>{try{return new Date(e.date||e.created_at)>=t}catch{return!1}})}e=e.sort((e,t)=>{try{const s=e.created_at||e.timestamp||e.date||0,a=t.created_at||t.timestamp||t.date||0;return new Date(a)-new Date(s)}catch{return 0}});const t=10*(z-1),s=t+10,a=e.slice(t,s),n=Math.ceil(e.length/10);return{transactions:a,total:e.length,totalPages:n,currentPage:z}},[i,J,z,10]);x.useEffect(()=>{U(1)},[J]);const X=(i||[]).filter(e=>e&&"expense"===e.type),ee=(i||[]).filter(e=>e&&"income"===e.type),te=X.reduce((e,t)=>e+(t.amount||0),0),se=ee.reduce((e,t)=>e+(t.amount||0),0),ae=se-te,ne=x.useMemo(()=>{if(!l)return null;return new $(i,l).getAllInsights(l.budgets||{})},[i,l]),ie=(null==ne?void 0:ne.dailyLimit)||{dailyRemaining:0,daysRemaining:0,formula:null},re=(null==ne?void 0:ne.forecast)||{forecastBalance:0},le=(null==ne?void 0:ne.comparison)||{current:0,previous:0,percentage:0,trend:"same"},ce=(null==ne?void 0:ne.overspending)||[],oe=(null==ne?void 0:ne.streak)||{days:0,isActive:!1,message:""},de=(null==ne?void 0:ne.automaticInsights)||[],he=ie.dailyLimit>0?Math.min(100,ie.dailyRemaining/ie.dailyLimit*100):0;return e.jsxs("div",{className:"container",children:[e.jsxs("nav",{className:"nav-bar",children:[e.jsxs("div",{className:"nav-links",children:[e.jsx(v,{to:"/",className:"nav-link active",children:"–ì–ª–∞–≤–Ω–∞—è"}),e.jsx(v,{to:"/analytics",className:"nav-link",children:"–ê–Ω–∞–ª–∏—Ç–∏–∫–∞"}),e.jsx(v,{to:"/goals",className:"nav-link",children:"–¶–µ–ª–∏"})]}),e.jsxs("div",{className:"user-info",children:[e.jsx("span",{className:"user-email",children:(null==t?void 0:t.email)||"–ó–∞–≥—Ä—É–∑–∫–∞..."}),e.jsx("button",{onClick:s,className:"btn-logout",children:"–í—ã—Ö–æ–¥"})]})]}),!o&&l&&l.monthlyIncome>0&&e.jsxs("div",{className:"hero-insight wow",children:[e.jsxs("div",{className:"hero-insight-content",children:[e.jsx("div",{className:"hero-icon",children:"üí∞"}),e.jsx("div",{className:"hero-label",children:"–ú–æ–∂–Ω–æ –ø–æ—Ç—Ä–∞—Ç–∏—Ç—å —Å–µ–≥–æ–¥–Ω—è"}),e.jsx("div",{className:"hero-value",children:Q(ie.dailyRemaining)}),e.jsxs("div",{className:"hero-subtitle",children:["–û—Å—Ç–∞–ª–æ—Å—å –¥–Ω–µ–π –≤ –º–µ—Å—è—Ü–µ: ",e.jsx("span",{children:ie.daysRemaining}),ie.formula&&e.jsx("button",{className:"hero-formula-btn",onClick:()=>D(!I),title:"–ö–∞–∫ —ç—Ç–æ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è?",children:"‚ÑπÔ∏è"})]}),I&&ie.formula&&e.jsxs("div",{className:"hero-formula-explanation",children:[e.jsx("p",{children:e.jsx("strong",{children:"–§–æ—Ä–º—É–ª–∞ —Ä–∞—Å—á–µ—Ç–∞:"})}),e.jsxs("p",{children:["–î–æ—Ö–æ–¥ (",Q(ie.formula.monthlyIncome),") ‚àí –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã (",Q(ie.formula.fixedExpenses),") = ",Q(ie.formula.availableForMonth)]}),e.jsxs("p",{children:[Q(ie.formula.availableForMonth)," √∑ ",ie.formula.daysInMonth," –¥–Ω–µ–π = ",Q(ie.formula.dailyLimit),"/–¥–µ–Ω—å"]}),e.jsxs("p",{children:["–û—Å—Ç–∞–ª–æ—Å—å ",Q(ie.formula.remainingForMonth)," √∑ ",ie.daysRemaining," –¥–Ω–µ–π = ",e.jsxs("strong",{children:[Q(ie.dailyRemaining),"/–¥–µ–Ω—å"]})]}),ie.dailyRemaining<.3*ie.dailyLimit&&e.jsx("p",{className:"formula-warning",children:"‚ö†Ô∏è –û—Å—Ç–∞–ª–æ—Å—å –º–µ–Ω–µ–µ 30% –æ—Ç –¥–Ω–µ–≤–Ω–æ–≥–æ –ª–∏–º–∏—Ç–∞. –ë—É–¥—å—Ç–µ –æ—Å—Ç–æ—Ä–æ–∂–Ω—ã —Å —Ç—Ä–∞—Ç–∞–º–∏!"})]})]}),e.jsx("div",{className:"hero-progress "+(he>50?"good":he>25?"warning":"danger"),style:{width:`${he}%`}})]}),o&&e.jsxs("div",{className:"loading-container",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö..."})]}),e.jsxs("div",{className:"stats-section",children:[e.jsxs("div",{className:"stat-card wow",children:[e.jsx("div",{className:"stat-icon income-icon",children:"‚Üë"}),e.jsx("span",{className:"stat-label",children:"–î–æ—Ö–æ–¥—ã"}),e.jsx("span",{className:"stat-value income",children:Q(se)})]}),e.jsxs("div",{className:"stat-card wow",children:[e.jsx("div",{className:"stat-icon expense-icon",children:"‚Üì"}),e.jsx("span",{className:"stat-label",children:"–†–∞—Å—Ö–æ–¥—ã"}),e.jsx("span",{className:"stat-value expense",children:Q(te)})]}),e.jsxs("div",{className:"stat-card wow balance-card",children:[e.jsx("div",{className:"stat-icon balance-icon",children:"‚öñ"}),e.jsx("span",{className:"stat-label",children:"–ë–∞–ª–∞–Ω—Å"}),e.jsx("span",{className:"stat-value balance "+(ae>=0?"positive":"negative"),children:Q(ae)})]})]}),(0!==re.forecastBalance||le.previous>0)&&e.jsxs("div",{className:"insights-grid",children:[0!==re.forecastBalance&&e.jsxs("div",{className:"forecast-card wow",children:[e.jsx("div",{className:"forecast-header",children:e.jsx("h3",{className:"forecast-title",children:"–ü—Ä–æ–≥–Ω–æ–∑ –¥–æ –∫–æ–Ω—Ü–∞ –º–µ—Å—è—Ü–∞"})}),e.jsxs("div",{className:"forecast-content",children:[e.jsx("div",{className:"forecast-value",style:{color:re.forecastBalance>=0?"var(--success)":"var(--danger)"},children:Q(re.forecastBalance)}),e.jsxs("div",{className:"forecast-details",children:[e.jsxs("div",{children:["–ü—Ä–æ–≥–Ω–æ–∑ —Ä–∞—Å—Ö–æ–¥–æ–≤: ",Q(re.projectedSpending||0)]}),e.jsxs("div",{children:["–¢–µ–∫—É—â–∏–µ —Ä–∞—Å—Ö–æ–¥—ã: ",Q(re.currentSpending||0)]})]})]})]}),le.previous>0&&e.jsxs("div",{className:"forecast-card wow",id:"comparisonCard",children:[e.jsx("div",{className:"forecast-header",children:e.jsx("h3",{className:"forecast-title",children:"–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –ø—Ä–æ—à–ª—ã–º –º–µ—Å—è—Ü–µ–º"})}),e.jsxs("div",{className:"forecast-content",children:[e.jsxs("div",{className:"forecast-value",style:{color:"up"===le.trend?"var(--danger)":"var(--success)"},children:["up"===le.trend?"üìà":"down"===le.trend?"üìâ":"‚û°Ô∏è"," ",Math.abs(le.percentage),"%"]}),e.jsxs("div",{className:"forecast-details",children:[e.jsxs("div",{children:["–¢–µ–∫—É—â–∏–π: ",Q(le.current)]}),e.jsxs("div",{children:["–ü—Ä–æ—à–ª—ã–π: ",Q(le.previous)]})]})]})]})]}),!o&&oe.isActive&&e.jsx("div",{className:"streak-card wow",children:e.jsxs("div",{className:"streak-content",children:[e.jsx("div",{className:"streak-icon",children:"üî•"}),e.jsxs("div",{className:"streak-info",children:[e.jsx("div",{className:"streak-label",children:"–î–Ω–µ–π –±–µ–∑ –ø–µ—Ä–µ—Ä–∞—Å—Ö–æ–¥–∞"}),e.jsxs("div",{className:"streak-value",children:[oe.days," –¥–Ω–µ–π"]}),e.jsx("div",{className:"streak-message",children:oe.message})]})]})}),!o&&de.length>0&&e.jsxs("div",{className:"insights-section",children:[e.jsx("h2",{className:"section-title",children:"–í–∞–∂–Ω—ã–µ –≤—ã–≤–æ–¥—ã"}),e.jsx("div",{className:"insights-list",children:de.map((t,s)=>e.jsxs("div",{className:`insight-card insight-${t.type} wow`,children:[e.jsx("div",{className:"insight-header",children:e.jsx("span",{className:"insight-title",children:t.title})}),e.jsx("div",{className:"insight-message",children:t.message})]},s))})]}),!o&&ce.length>0&&e.jsx("div",{className:"alerts-container",children:ce.map((t,s)=>e.jsxs("div",{className:"alert "+("over"===t.status?"alert-danger":"alert-warning"),children:[e.jsx("strong",{children:t.category}),": –ø—Ä–µ–≤—ã—à–µ–Ω –±—é–¥–∂–µ—Ç –Ω–∞ ",Q(Math.abs(t.remaining)),"(",t.percentage,"% –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ)"]},s))}),e.jsx("div",{className:"form-section",children:e.jsxs("div",{className:"transaction-tabs",style:{marginBottom:"20px"},children:[e.jsx("button",{className:"transaction-tab "+("transactions"===G?"active":""),onClick:()=>B("transactions"),children:"–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏"}),e.jsx("button",{className:"transaction-tab "+("savings"===G?"active":""),onClick:()=>B("savings"),children:"–û—Ç–∫–ª–∞–¥—ã–≤–∞—Ç—å"})]})}),"transactions"===G&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"form-section",children:[e.jsxs("div",{className:"transaction-tabs",children:[e.jsx("button",{className:"transaction-tab "+("expense"===f?"active":""),onClick:()=>N("expense"),children:"–†–∞—Å—Ö–æ–¥"}),e.jsx("button",{className:"transaction-tab "+("income"===f?"active":""),onClick:()=>N("income"),children:"–î–æ—Ö–æ–¥"})]}),e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),!h||!u)return;const t={type:f,amount:parseFloat(h),date:u,category:"expense"===f?p:"",description:"income"===f?b:""};try{await n.saveTransaction(t),await H(),m(""),y(""),w("")}catch(s){alert("–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏")}},className:"expense-form",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"–°—É–º–º–∞ (—Å—É–º)"}),e.jsx("input",{type:"number",className:"form-input",value:h,onChange:e=>m(e.target.value),required:!0,step:"1000",min:"0"})]}),"expense"===f?e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{className:"form-label",children:["–ö–∞—Ç–µ–≥–æ—Ä–∏—è",e.jsx("button",{type:"button",onClick:()=>A(!0),style:{marginLeft:"10px",padding:"4px 8px",fontSize:"0.75rem",background:"var(--primary)",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"‚úèÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ"})]}),e.jsxs("select",{className:"form-input",value:p,onChange:e=>y(e.target.value),required:!0,children:[e.jsx("option",{value:"",children:"–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é"}),k.map(t=>e.jsx("option",{value:t,children:t},t))]})]}):e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"–û–ø–∏—Å–∞–Ω–∏–µ"}),e.jsx("input",{type:"text",className:"form-input",value:b,onChange:e=>w(e.target.value),placeholder:"–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–æ—Ö–æ–¥–∞"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"–î–∞—Ç–∞"}),e.jsx("input",{type:"date",className:"form-input",value:u,onChange:e=>g(e.target.value),required:!0})]}),e.jsxs("button",{type:"submit",className:"btn btn-primary btn-full",children:["–î–æ–±–∞–≤–∏—Ç—å ","expense"===f?"—Ä–∞—Å—Ö–æ–¥":"–¥–æ—Ö–æ–¥"]})]})]}),e.jsxs("div",{className:"form-section",style:{marginTop:"20px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px"},children:[e.jsx("h2",{className:"section-title",style:{margin:0},children:"–ü–æ—Å–ª–µ–¥–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏"}),e.jsxs("select",{value:J,onChange:e=>Y(e.target.value),style:{padding:"6px 12px",background:"var(--bg-secondary)",border:"1px solid var(--border)",borderRadius:"6px",color:"var(--text-primary)",fontSize:"0.9rem",cursor:"pointer"},children:[e.jsx("option",{value:"all",children:"–í—Å–µ"}),e.jsx("option",{value:"day",children:"–°–µ–≥–æ–¥–Ω—è"}),e.jsx("option",{value:"week",children:"–ù–µ–¥–µ–ª—è"}),e.jsx("option",{value:"month",children:"–ú–µ—Å—è—Ü"})]})]}),e.jsx("div",{className:"expenses-list",children:o||0!==V.total?!o&&V.transactions.length>0?e.jsxs(e.Fragment,{children:[V.transactions.map(t=>{if(!t)return null;const s=new Date(t.date||t.created_at),a=(new Date).toDateString()===s.toDateString();return e.jsxs("div",{className:"expense-item "+("income"===t.type?"income-item":""),style:{marginBottom:"8px"},children:[e.jsx("div",{className:"expense-category",children:"income"===t.type?"+":"‚àí"}),e.jsxs("div",{className:"expense-details",style:{flex:1},children:[e.jsx("div",{className:"expense-category-name",children:"income"===t.type?t.description||"–î–æ—Ö–æ–¥":t.category||"–î—Ä—É–≥–æ–µ"}),e.jsx("div",{className:"expense-date",style:{fontSize:"0.85rem",color:"var(--text-secondary)"},children:a?`–°–µ–≥–æ–¥–Ω—è, ${s.toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit"})}`:s.toLocaleDateString("ru-RU",{day:"numeric",month:"long",hour:"2-digit",minute:"2-digit"})})]}),e.jsxs("div",{className:"expense-amount "+("income"===t.type?"income-amount":""),children:["income"===t.type?"+":"‚àí",Q(t.amount||0)]}),e.jsx("button",{onClick:()=>(async e=>{try{await n.deleteTransaction(e),await H()}catch(t){alert("–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏")}})(t.id),className:"btn-delete",style:{marginLeft:"10px"},title:"–£–¥–∞–ª–∏—Ç—å",children:"√ó"})]},t.id)}),V.totalPages>1&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"20px",paddingTop:"15px",borderTop:"1px solid var(--border)"},children:[e.jsx("button",{onClick:()=>U(e=>Math.max(1,e-1)),disabled:1===V.currentPage,className:"btn btn-secondary",style:{opacity:1===V.currentPage?.5:1,cursor:1===V.currentPage?"not-allowed":"pointer"},children:"‚Üê –ù–∞–∑–∞–¥"}),e.jsxs("span",{style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:["–°—Ç—Ä–∞–Ω–∏—Ü–∞ ",V.currentPage," –∏–∑ ",V.totalPages," ","(–≤—Å–µ–≥–æ ",V.total," —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π)"]}),e.jsx("button",{onClick:()=>U(e=>Math.min(V.totalPages,e+1)),disabled:V.currentPage===V.totalPages,className:"btn btn-secondary",style:{opacity:V.currentPage===V.totalPages?.5:1,cursor:V.currentPage===V.totalPages?"not-allowed":"pointer"},children:"–í–ø–µ—Ä–µ–¥ ‚Üí"})]})]}):null:e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"empty-icon",children:"üìä"}),e.jsx("h3",{className:"empty-title",children:"–ù–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π"}),e.jsx("p",{className:"empty-description",children:"all"!==J?"–ù–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥.":"–ù–∞—á–Ω–∏—Ç–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —Å–≤–æ–∏ —Ñ–∏–Ω–∞–Ω—Å—ã. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤—É—é —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –≤—ã—à–µ."})]})})]})]}),"savings"===G&&e.jsxs("div",{className:"form-section",children:[e.jsx("h2",{className:"section-title",children:"–û—Ç–∫–ª–∞–¥—ã–≤–∞—Ç—å –¥–µ–Ω—å–≥–∏"}),l&&l.monthlyIncome?e.jsx(L,{transactions:i,userSettings:l,formatAmount:Q,dataService:n}):e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"empty-icon",children:"üí∞"}),e.jsx("p",{children:"–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –¥–æ—Ö–æ–¥ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –æ—Ç–∫–ª–∞–¥—ã–≤–∞–Ω–∏—é"})]})]}),M&&e.jsx("div",{className:"modal",style:{display:"flex"},onClick:e=>"modal"===e.target.className&&A(!1),children:e.jsxs("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h2",{children:"–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏"}),e.jsx("button",{onClick:()=>{A(!1),q(null),E("")},className:"modal-close",children:"√ó"})]}),e.jsx("div",{className:"modal-body",children:e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),P.trim())try{await n.saveCategory({id:null==R?void 0:R.id,name:P.trim()}),await Z(),A(!1),E(""),q(null)}catch(t){alert("–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏")}},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏"}),e.jsx("input",{type:"text",className:"form-input",value:P,onChange:e=>E(e.target.value),placeholder:"–ù–∞–ø—Ä–∏–º–µ—Ä: –ü–æ–¥–ø–∏—Å–∫–∏",required:!0})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",onClick:()=>{A(!1),q(null),E("")},className:"btn btn-secondary",children:"–û—Ç–º–µ–Ω–∞"}),e.jsx("button",{type:"submit",className:"btn btn-primary",children:R?"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å":"–î–æ–±–∞–≤–∏—Ç—å"})]})]})})]})}),e.jsx(F,{})]})}function G(){var t;const{user:s,logout:a}=T(),n=O(),[i,r]=x.useState([]),[l,c]=x.useState(null),[o,d]=x.useState("all"),[h,p]=x.useState(!0),[j,y]=x.useState(!1);x.useEffect(()=>{f()},[o]);const f=async()=>{p(!0);try{const e=await n.getTransactions();let t=Array.isArray(e)?e:[];if("month"===o){const s=new Date,a=new Date(s.getFullYear(),s.getMonth(),1);t=e.filter(e=>{if(!e||!e.date&&!e.created_at)return!1;try{return new Date(e.date||e.created_at)>=a}catch{return!1}})}else if("week"===o){const s=new Date;s.setDate(s.getDate()-7),t=e.filter(e=>{if(!e||!e.date&&!e.created_at)return!1;try{return new Date(e.date||e.created_at)>=s}catch{return!1}})}r(t.filter(e=>e&&(e.created_at||e.timestamp||e.date)).sort((e,t)=>{try{const s=e.created_at||e.timestamp||e.date||0,a=t.created_at||t.timestamp||t.date||0;return new Date(a)-new Date(s)}catch{return 0}}));const s=await n.getUserSettings();c(s),y(!0)}catch(e){y(!0)}finally{p(!1)}},N=e=>new Intl.NumberFormat("ru-RU").format(e)+" —Å—É–º",b=(i||[]).filter(e=>e&&"expense"===e.type),w=(i||[]).filter(e=>e&&"income"===e.type),S=b.reduce((e,t)=>e+(t.amount||0),0),C=w.reduce((e,t)=>e+(t.amount||0),0),I=C-S,D={};b.forEach(e=>{if(!e)return;const t=e.category||"–î—Ä—É–≥–æ–µ";D[t]=(D[t]||0)+(e.amount||0)});const k=x.useMemo(()=>{if(!l)return null;return new $(i,l).getAllInsights(l.budgets||{})},[i,l]),_=x.useMemo(()=>{const e=new Date,t="week"===o?7:"month"===o?30:Math.min(30,(i||[]).length||30),s={},a={};(i||[]).forEach(e=>{if(e&&(e.date||e.created_at))try{const t=new Date(e.date||e.created_at).toLocaleDateString("ru-RU",{day:"2-digit",month:"2-digit"});"expense"===e.type?s[t]=(s[t]||0)+(e.amount||0):"income"===e.type&&(a[t]=(a[t]||0)+(e.amount||0))}catch{}});const n=[],r=[],l=[];for(let i=t-1;i>=0;i--){const t=new Date(e);t.setDate(t.getDate()-i);const c=t.toLocaleDateString("ru-RU",{day:"2-digit",month:"2-digit"});n.push(c),r.push(s[c]||0),l.push(a[c]||0)}return{dates:n,expenseData:r,incomeData:l}},[i,o]),M={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0,position:"top",labels:{color:"#e5e7eb",font:{size:12}}},tooltip:{callbacks:{label:e=>N(e.parsed.y)}}},scales:{y:{beginAtZero:!0,ticks:{color:"#9ca3af",callback:e=>e>=1e6?(e/1e6).toFixed(1)+"–ú":e>=1e3?(e/1e3).toFixed(0)+"–ö":e},grid:{color:"rgba(156, 163, 175, 0.1)"}},x:{ticks:{color:"#9ca3af"},grid:{display:!1}}}},A={labels:_.dates,datasets:[{label:"–†–∞—Å—Ö–æ–¥—ã",data:_.expenseData,borderColor:"rgb(239, 68, 68)",backgroundColor:"rgba(239, 68, 68, 0.1)",borderWidth:2,fill:!0,tension:.4}]},P={labels:_.dates,datasets:[{label:"–î–æ—Ö–æ–¥—ã",data:_.incomeData,borderColor:"rgb(16, 185, 129)",backgroundColor:"rgba(16, 185, 129, 0.1)",borderWidth:2,fill:!0,tension:.4}]},E=Object.keys(D),R=E.map(e=>D[e]),L={labels:E,datasets:[{data:R,backgroundColor:["rgba(99, 102, 241, 0.8)","rgba(239, 68, 68, 0.8)","rgba(245, 158, 11, 0.8)","rgba(16, 185, 129, 0.8)","rgba(236, 72, 153, 0.8)","rgba(59, 130, 246, 0.8)","rgba(139, 92, 246, 0.8)"].slice(0,E.length),borderWidth:0}]},q={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{color:"#e5e7eb",padding:15,font:{size:11}}},tooltip:{callbacks:{label:e=>{const t=e.label||"",s=e.parsed||0,a=(s/e.dataset.data.reduce((e,t)=>e+t,0)*100).toFixed(1);return`${t}: ${N(s)} (${a}%)`}}}}},G={labels:_.dates,datasets:[{label:"–î–æ—Ö–æ–¥—ã",data:_.incomeData,backgroundColor:"rgba(16, 185, 129, 0.7)",borderColor:"rgb(16, 185, 129)",borderWidth:1},{label:"–†–∞—Å—Ö–æ–¥—ã",data:_.expenseData,backgroundColor:"rgba(239, 68, 68, 0.7)",borderColor:"rgb(239, 68, 68)",borderWidth:1}]},B=b.length>0?S/Math.max(i.length,1):0,z=Object.entries(D).sort((e,t)=>t[1]-e[1])[0],U=(null==(t=null==k?void 0:k.comparison)?void 0:t.trend)||"same";return e.jsxs("div",{className:"container",children:[e.jsxs("nav",{className:"nav-bar",children:[e.jsxs("div",{className:"nav-links",children:[e.jsx(v,{to:"/",className:"nav-link",children:"–ì–ª–∞–≤–Ω–∞—è"}),e.jsx(v,{to:"/analytics",className:"nav-link active",children:"–ê–Ω–∞–ª–∏—Ç–∏–∫–∞"}),e.jsx(v,{to:"/goals",className:"nav-link",children:"–¶–µ–ª–∏"})]}),e.jsxs("div",{className:"user-info",children:[e.jsx("span",{className:"user-email",children:(null==s?void 0:s.email)||"–ó–∞–≥—Ä—É–∑–∫–∞..."}),e.jsx("button",{onClick:a,className:"btn-logout",children:"–í—ã—Ö–æ–¥"})]})]}),e.jsx("header",{className:"analytics-header",children:e.jsxs("div",{className:"analytics-header-content",children:[e.jsx("h1",{className:"analytics-title",children:"–ê–Ω–∞–ª–∏—Ç–∏–∫–∞"}),e.jsx("p",{className:"analytics-subtitle",children:"–ì–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑ –≤–∞—à–∏—Ö —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö"})]})}),h&&!j&&e.jsxs("div",{className:"loading-container",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"–ó–∞–≥—Ä—É–∑–∫–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏..."})]}),(!h||j)&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"form-section",children:e.jsxs("div",{className:"period-filter",children:[e.jsx("button",{className:"period-btn "+("all"===o?"active":""),onClick:()=>d("all"),children:"–í—Å–µ –≤—Ä–µ–º—è"}),e.jsx("button",{className:"period-btn "+("month"===o?"active":""),onClick:()=>d("month"),children:"–ú–µ—Å—è—Ü"}),e.jsx("button",{className:"period-btn "+("week"===o?"active":""),onClick:()=>d("week"),children:"–ù–µ–¥–µ–ª—è"})]})}),i.length>0&&e.jsxs("div",{className:"insights-section",children:[e.jsx("h2",{className:"section-title",children:"–ö–ª—é—á–µ–≤—ã–µ –∏–Ω—Å–∞–π—Ç—ã"}),e.jsxs("div",{className:"insights-grid",children:[e.jsxs("div",{className:"insight-card insight-info wow",children:[e.jsx("div",{className:"insight-header",children:e.jsx("span",{className:"insight-title",children:"üí∞ –°—Ä–µ–¥–Ω–∏–π —Ä–∞—Å—Ö–æ–¥ –≤ –¥–µ–Ω—å"})}),e.jsx("div",{className:"insight-message",children:N(B)})]}),z&&e.jsxs("div",{className:"insight-card insight-warning wow",children:[e.jsx("div",{className:"insight-header",children:e.jsx("span",{className:"insight-title",children:"üìä –°–∞–º–∞—è –∑–∞—Ç—Ä–∞—Ç–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è"})}),e.jsxs("div",{className:"insight-message",children:[e.jsx("strong",{children:z[0]})," ‚Äî ",N(z[1]),"(",S>0?(z[1]/S*100).toFixed(1):0,"%)"]})]}),(null==k?void 0:k.comparison)&&k.comparison.previous>0&&e.jsxs("div",{className:`insight-card insight-${"up"===U?"danger":"down"===U?"success":"info"} wow`,children:[e.jsx("div",{className:"insight-header",children:e.jsxs("span",{className:"insight-title",children:["up"===U?"üìà":"down"===U?"üìâ":"‚û°Ô∏è"," –¢—Ä–µ–Ω–¥ —Ä–∞—Å—Ö–æ–¥–æ–≤"]})}),e.jsxs("div",{className:"insight-message",children:["up"===U?"–†–æ—Å—Ç":"down"===U?"–°–Ω–∏–∂–µ–Ω–∏–µ":"–ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π"," –Ω–∞ ",Math.abs(k.comparison.percentage),"%","down"===U&&" ‚Äî –æ—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!"]})]})]})]}),e.jsxs("div",{className:"stats-section",children:[e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon income-icon",children:"‚Üë"}),e.jsx("span",{className:"stat-label",children:"–î–æ—Ö–æ–¥—ã"}),e.jsx("span",{className:"stat-value income",children:N(C)})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon expense-icon",children:"‚Üì"}),e.jsx("span",{className:"stat-label",children:"–†–∞—Å—Ö–æ–¥—ã"}),e.jsx("span",{className:"stat-value expense",children:N(S)})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon balance-icon",children:"‚öñ"}),e.jsx("span",{className:"stat-label",children:"–ë–∞–ª–∞–Ω—Å"}),e.jsx("span",{className:"stat-value balance "+(I>=0?"positive":"negative"),children:N(I)})]})]}),i.length>0?e.jsxs("div",{className:"charts-section",children:[e.jsxs("div",{className:"section-header-large",children:[e.jsx("h2",{className:"section-title",children:"–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö"}),e.jsx("p",{className:"section-subtitle",children:"–ì—Ä–∞—Ñ–∏–∫–∏ –∏ –¥–∏–∞–≥—Ä–∞–º–º—ã –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –≤–∞—à–∏—Ö —Ñ–∏–Ω–∞–Ω—Å–æ–≤"})]}),e.jsxs("div",{className:"charts-grid",children:[b.length>0?e.jsxs("div",{className:"chart-card wow",children:[e.jsxs("div",{className:"chart-header",children:[e.jsx("div",{className:"chart-icon",children:"üìâ"}),e.jsxs("div",{children:[e.jsx("h3",{className:"chart-title",children:"–†–∞—Å—Ö–æ–¥—ã –ø–æ –¥–∞—Ç–∞–º"}),e.jsx("p",{className:"chart-description",children:"–î–∏–Ω–∞–º–∏–∫–∞ –≤–∞—à–∏—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤ –≤–æ –≤—Ä–µ–º–µ–Ω–∏. –í–∏–¥–Ω–æ, –≤ –∫–∞–∫–∏–µ –¥–Ω–∏ —Ç—Ä–∞—Ç—ã –±–æ–ª—å—à–µ –∏–ª–∏ –º–µ–Ω—å—à–µ."})]})]}),e.jsx("div",{className:"chart-container",children:e.jsx(m,{data:A,options:M})})]}):e.jsxs("div",{className:"chart-card wow",children:[e.jsxs("div",{className:"chart-header",children:[e.jsx("div",{className:"chart-icon",children:"üìâ"}),e.jsxs("div",{children:[e.jsx("h3",{className:"chart-title",children:"–†–∞—Å—Ö–æ–¥—ã –ø–æ –¥–∞—Ç–∞–º"}),e.jsx("p",{className:"chart-description",children:'–î–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–∞ —Ä–∞—Å—Ö–æ–¥–æ–≤ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–æ–±–∞–≤–∏—Ç—å —Ö–æ—Ç—è –±—ã –æ–¥–Ω—É —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é —Å —Ç–∏–ø–æ–º "–†–∞—Å—Ö–æ–¥".'})]})]}),e.jsxs("div",{className:"chart-container",style:{padding:"40px",textAlign:"center",color:"var(--text-secondary)"},children:[e.jsx("p",{children:"–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–∞ —Ä–∞—Å—Ö–æ–¥–æ–≤"}),e.jsx("p",{style:{marginTop:"10px",fontSize:"0.9em"},children:"–î–æ–±–∞–≤—å—Ç–µ —Ä–∞—Å—Ö–æ–¥—ã –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ"})]})]}),w.length>0?e.jsxs("div",{className:"chart-card wow",children:[e.jsxs("div",{className:"chart-header",children:[e.jsx("div",{className:"chart-icon",children:"üìà"}),e.jsxs("div",{children:[e.jsx("h3",{className:"chart-title",children:"–î–æ—Ö–æ–¥—ã –ø–æ –¥–∞—Ç–∞–º"}),e.jsx("p",{className:"chart-description",children:"–ö–∞–∫ –∏–∑–º–µ–Ω—è—é—Ç—Å—è –≤–∞—à–∏ –¥–æ—Ö–æ–¥—ã. –û—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ —Ä–µ–≥—É–ª—è—Ä–Ω–æ—Å—Ç—å –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏–π."})]})]}),e.jsx("div",{className:"chart-container",children:e.jsx(m,{data:P,options:M})})]}):e.jsxs("div",{className:"chart-card wow",children:[e.jsxs("div",{className:"chart-header",children:[e.jsx("div",{className:"chart-icon",children:"üìà"}),e.jsxs("div",{children:[e.jsx("h3",{className:"chart-title",children:"–î–æ—Ö–æ–¥—ã –ø–æ –¥–∞—Ç–∞–º"}),e.jsx("p",{className:"chart-description",children:'–î–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–∞ –¥–æ—Ö–æ–¥–æ–≤ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–æ–±–∞–≤–∏—Ç—å —Ö–æ—Ç—è –±—ã –æ–¥–Ω—É —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é —Å —Ç–∏–ø–æ–º "–î–æ—Ö–æ–¥".'})]})]}),e.jsxs("div",{className:"chart-container",style:{padding:"40px",textAlign:"center",color:"var(--text-secondary)"},children:[e.jsx("p",{children:"–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–∞ –¥–æ—Ö–æ–¥–æ–≤"}),e.jsx("p",{style:{marginTop:"10px",fontSize:"0.9em"},children:"–î–æ–±–∞–≤—å—Ç–µ –¥–æ—Ö–æ–¥—ã –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ"})]})]}),b.length>0&&E.length>0?e.jsxs("div",{className:"chart-card wow",children:[e.jsxs("div",{className:"chart-header",children:[e.jsx("div",{className:"chart-icon",children:"ü•ß"}),e.jsxs("div",{children:[e.jsx("h3",{className:"chart-title",children:"–†–∞—Å—Ö–æ–¥—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º"}),e.jsx("p",{className:"chart-description",children:"–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç—Ä–∞—Ç –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º. –ö–∞–∫–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è –∑–∞–±–∏—Ä–∞–µ—Ç –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ?"})]})]}),e.jsx("div",{className:"chart-container",children:e.jsx(u,{data:L,options:q})})]}):e.jsxs("div",{className:"chart-card wow",children:[e.jsxs("div",{className:"chart-header",children:[e.jsx("div",{className:"chart-icon",children:"ü•ß"}),e.jsxs("div",{children:[e.jsx("h3",{className:"chart-title",children:"–†–∞—Å—Ö–æ–¥—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º"}),e.jsx("p",{className:"chart-description",children:"–î–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–∏–∞–≥—Ä–∞–º–º—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–æ–±–∞–≤–∏—Ç—å —Ä–∞—Å—Ö–æ–¥—ã —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏."})]})]}),e.jsxs("div",{className:"chart-container",style:{padding:"40px",textAlign:"center",color:"var(--text-secondary)"},children:[e.jsx("p",{children:"–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–∏–∞–≥—Ä–∞–º–º—ã"}),e.jsx("p",{style:{marginTop:"10px",fontSize:"0.9em"},children:"–î–æ–±–∞–≤—å—Ç–µ —Ä–∞—Å—Ö–æ–¥—ã —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ"})]})]}),b.length>0||w.length>0?e.jsxs("div",{className:"chart-card wow full-width",children:[e.jsxs("div",{className:"chart-header",children:[e.jsx("div",{className:"chart-icon",children:"‚öñ"}),e.jsxs("div",{children:[e.jsx("h3",{className:"chart-title",children:"–î–æ—Ö–æ–¥—ã vs –†–∞—Å—Ö–æ–¥—ã"}),e.jsx("p",{className:"chart-description",children:"–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–æ—Ö–æ–¥–æ–≤ –∏ —Ä–∞—Å—Ö–æ–¥–æ–≤. –ó–µ–ª—ë–Ω—ã–µ —Å—Ç–æ–ª–±—Ü—ã ‚Äî –¥–æ—Ö–æ–¥—ã, –∫—Ä–∞—Å–Ω—ã–µ ‚Äî —Ä–∞—Å—Ö–æ–¥—ã."})]})]}),e.jsx("div",{className:"chart-container",children:e.jsx(g,{data:G,options:M})})]}):e.jsxs("div",{className:"chart-card wow full-width",children:[e.jsxs("div",{className:"chart-header",children:[e.jsx("div",{className:"chart-icon",children:"‚öñ"}),e.jsxs("div",{children:[e.jsx("h3",{className:"chart-title",children:"–î–æ—Ö–æ–¥—ã vs –†–∞—Å—Ö–æ–¥—ã"}),e.jsx("p",{className:"chart-description",children:"–î–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –¥–æ—Ö–æ–¥–æ–≤ –∏ —Ä–∞—Å—Ö–æ–¥–æ–≤ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–æ–±–∞–≤–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –æ–±–æ–∏—Ö —Ç–∏–ø–æ–≤."})]})]}),e.jsxs("div",{className:"chart-container",style:{padding:"40px",textAlign:"center",color:"var(--text-secondary)"},children:[e.jsx("p",{children:"–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è"}),e.jsx("p",{style:{marginTop:"10px",fontSize:"0.9em"},children:"–î–æ–±–∞–≤—å—Ç–µ –¥–æ—Ö–æ–¥—ã –∏ —Ä–∞—Å—Ö–æ–¥—ã –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ"})]})]})]})]}):e.jsxs("div",{className:"empty-state wow",children:[e.jsx("div",{className:"empty-icon",children:"üìä"}),e.jsx("h3",{className:"empty-title",children:"–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏"}),e.jsx("p",{className:"empty-description",children:"–î–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–æ–±–∞–≤–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (–¥–æ—Ö–æ–¥—ã –∏–ª–∏ —Ä–∞—Å—Ö–æ–¥—ã) –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ."}),e.jsx("p",{className:"empty-description",style:{marginTop:"10px",fontSize:"0.9em",color:"var(--text-secondary)"},children:"–ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –∑–¥–µ—Å—å –ø–æ—è–≤—è—Ç—Å—è –≥—Ä–∞—Ñ–∏–∫–∏, –¥–∏–∞–≥—Ä–∞–º–º—ã –∏ –∫–ª—é—á–µ–≤—ã–µ –∏–Ω—Å–∞–π—Ç—ã."})]}),e.jsxs("div",{className:"form-section",children:[e.jsx("h2",{className:"section-title",children:"–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º"}),e.jsx("div",{className:"category-breakdown",children:0===Object.keys(D).length?e.jsx("p",{style:{color:"var(--text-secondary)",textAlign:"center",padding:"20px"},children:"–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è"}):Object.entries(D).sort((e,t)=>t[1]-e[1]).map(([t,s])=>{const a=S>0?(s/S*100).toFixed(1):0;return e.jsxs("div",{className:"category-item",children:[e.jsxs("div",{className:"category-info",children:[e.jsx("span",{className:"category-name",children:t}),e.jsx("span",{className:"category-amount",children:N(s)})]}),e.jsxs("div",{className:"category-percentage",children:[a,"%"]})]},t)})})]})]}),e.jsx(F,{})]})}function B(){const{user:t,logout:s}=T(),a=O(),[n,i]=x.useState([]),[r,l]=x.useState(!1),[c,o]=x.useState(null),[d,h]=x.useState({title:"",description:"",target_amount:"",deadline:""}),[m,u]=x.useState([]),[g,p]=x.useState({}),[j,y]=x.useState(null),[f,N]=x.useState({});x.useEffect(()=>{(async()=>{try{await Promise.all([S(),b()])}catch(e){}})()},[]);const b=async()=>{try{const e=await a.getCategories();Array.isArray(e)?u(e):u([])}catch(e){u([])}},w=async e=>{if(e)try{const t=await a.getGoalCalculations(e);t&&"object"==typeof t&&p(s=>({...s,[e]:t}))}catch(t){}},S=async()=>{try{const e=await a.getGoals();Array.isArray(e)?i(e):i([])}catch(e){i([])}},C=()=>{l(!1),o(null),h({title:"",description:"",target_amount:"",deadline:""})},I=e=>new Intl.NumberFormat("ru-RU").format(e)+" —Å—É–º";return e.jsxs("div",{className:"container",children:[e.jsxs("nav",{className:"nav-bar",children:[e.jsxs("div",{className:"nav-links",children:[e.jsx(v,{to:"/",className:"nav-link",children:"–ì–ª–∞–≤–Ω–∞—è"}),e.jsx(v,{to:"/analytics",className:"nav-link",children:"–ê–Ω–∞–ª–∏—Ç–∏–∫–∞"}),e.jsx(v,{to:"/goals",className:"nav-link active",children:"–¶–µ–ª–∏"})]}),e.jsxs("div",{className:"user-info",children:[e.jsx("span",{className:"user-email",children:(null==t?void 0:t.email)||"–ó–∞–≥—Ä—É–∑–∫–∞..."}),e.jsx("button",{onClick:s,className:"btn-logout",children:"–í—ã—Ö–æ–¥"})]})]}),e.jsxs("header",{className:"header",children:[e.jsx("h1",{className:"header-title",children:"–§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —Ü–µ–ª–∏"}),e.jsx("p",{className:"header-subtitle",children:"–°—Ç–∞–≤—å—Ç–µ —Ü–µ–ª–∏ –∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ –ø—Ä–æ–≥—Ä–µ—Å—Å"})]}),e.jsx("div",{className:"form-section",children:e.jsx("button",{onClick:()=>l(!0),className:"btn btn-primary",children:"+ –î–æ–±–∞–≤–∏—Ç—å —Ü–µ–ª—å"})}),e.jsx("div",{className:"form-section",children:0===n.length?e.jsxs("div",{style:{textAlign:"center",padding:"60px 20px",color:"var(--text-secondary)"},children:[e.jsx("div",{style:{fontSize:"3rem",marginBottom:"16px"},children:"üéØ"}),e.jsx("p",{children:"–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö —Ü–µ–ª–µ–π"}),e.jsx("p",{style:{fontSize:"0.875rem",marginTop:"8px"},children:"–°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤—É—é —Ü–µ–ª—å, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –Ω–∞–∫–∞–ø–ª–∏–≤–∞—Ç—å"})]}):e.jsx("div",{className:"goals-grid",children:n.map(t=>{if(!t||!t.id)return null;const s=t.progress_percentage||(t.current_amount||0)/(t.target_amount||1)*100;return e.jsxs("div",{className:"goal-card wow",children:[e.jsxs("div",{className:"goal-header",children:[e.jsx("h3",{className:"goal-title",children:t.title}),e.jsxs("div",{className:"goal-actions",children:[e.jsx("button",{onClick:()=>(e=>{var t;o(e),h({title:e.title||"",description:e.description||"",target_amount:(null==(t=e.target_amount)?void 0:t.toString())||"",deadline:e.deadline||""}),l(!0)})(t),className:"btn-sm",children:"‚úèÔ∏è"}),e.jsx("button",{onClick:()=>(async e=>{if(confirm("–£–¥–∞–ª–∏—Ç—å —ç—Ç—É —Ü–µ–ª—å?"))try{await a.deleteGoal(e),await S()}catch(t){alert("–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —Ü–µ–ª–∏")}})(t.id),className:"btn-sm",children:"üóëÔ∏è"})]})]}),t.description&&e.jsx("p",{className:"goal-description",children:t.description}),e.jsxs("div",{className:"goal-progress",children:[e.jsxs("div",{className:"goal-progress-info",children:[e.jsx("span",{className:"goal-current",children:I(t.current_amount||0)}),e.jsx("span",{className:"goal-separator",children:"/"}),e.jsx("span",{className:"goal-target",children:I(t.target_amount)})]}),e.jsx("div",{className:"goal-progress-bar-wrapper",children:e.jsx("div",{className:"goal-progress-bar",style:{width:`${Math.min(100,s)}%`,backgroundColor:(n=s,n>=100?"var(--success)":n>=75?"var(--primary)":n>=50?"var(--warning)":"var(--danger)")}})}),e.jsxs("div",{className:"goal-progress-percentage",children:[Math.round(s),"%"]})]}),t.deadline&&e.jsxs("div",{className:"goal-deadline",children:["–°—Ä–æ–∫: ",new Date(t.deadline).toLocaleDateString("ru-RU")]}),e.jsx("div",{className:"goal-status",children:e.jsx("span",{className:`goal-status-badge ${t.status}`,children:"completed"===t.status?"‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–∞":"cancelled"===t.status?"‚ùå –û—Ç–º–µ–Ω–µ–Ω–∞":"üîÑ –ê–∫—Ç–∏–≤–Ω–∞"})}),"active"===t.status&&e.jsx("button",{onClick:()=>{j===t.id?y(null):(y(t.id),w(t.id))},className:"btn btn-secondary",style:{marginTop:"15px",width:"100%",fontSize:"0.9rem"},children:j===t.id?"–°–∫—Ä—ã—Ç—å –¥–µ—Ç–∞–ª–∏":"–ü–æ–∫–∞–∑–∞—Ç—å –¥–µ—Ç–∞–ª–∏"}),j===t.id&&"active"===t.status&&e.jsxs("div",{style:{marginTop:"20px",paddingTop:"20px",borderTop:"1px solid var(--border)"},children:[g[t.id]&&e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("h4",{style:{fontSize:"1rem",marginBottom:"10px"},children:"–†–∞—Å—á–µ—Ç—ã –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ü–µ–ª–∏"}),e.jsx("div",{className:"insight-card",style:{marginBottom:"10px"},children:e.jsxs("div",{style:{fontSize:"0.9rem"},children:[e.jsxs("div",{children:[e.jsx("strong",{children:"–¢–µ–∫—É—â–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è:"})," ",I(g[t.id].current_savings_rate||0),"/–º–µ—Å"]}),g[t.id].total_savings_rate>0&&e.jsxs("div",{style:{marginTop:"5px"},children:[e.jsx("strong",{children:"–° —É—á–µ—Ç–æ–º —ç–∫–æ–Ω–æ–º–∏–∏:"})," ",I(g[t.id].total_savings_rate||0),"/–º–µ—Å"]}),g[t.id].projected_date&&e.jsxs("div",{style:{marginTop:"5px",color:"late"===g[t.id].deadline_status?"var(--danger)":"var(--success)"},children:[e.jsx("strong",{children:"–ü—Ä–æ–≥–Ω–æ–∑–∏—Ä—É–µ–º–∞—è –¥–∞—Ç–∞:"})," ",new Date(g[t.id].projected_date).toLocaleDateString("ru-RU"),"late"===g[t.id].deadline_status&&" ‚ö†Ô∏è –ü–æ–∑–∂–µ —Å—Ä–æ–∫–∞"]}),g[t.id].recommended_daily&&e.jsxs("div",{style:{marginTop:"10px",padding:"10px",background:"var(--bg-secondary)",borderRadius:"8px"},children:[e.jsx("strong",{children:"–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –æ—Ç–∫–ª–∞–¥—ã–≤–∞—Ç—å:"}),e.jsxs("div",{style:{marginTop:"5px"},children:[I(g[t.id].recommended_daily||0),"/–¥–µ–Ω—å –∏–ª–∏ ",I(g[t.id].recommended_monthly||0),"/–º–µ—Å"]})]})]})})]}),e.jsxs("div",{children:[e.jsx("h4",{style:{fontSize:"1rem",marginBottom:"10px"},children:"–ö–∞—Ç–µ–≥–æ—Ä–∏–∏, –≤–ª–∏—è—é—â–∏–µ –Ω–∞ —Ü–µ–ª—å"}),e.jsx("p",{style:{fontSize:"0.85rem",color:"var(--text-secondary)",marginBottom:"10px"},children:"–£–∫–∞–∂–∏—Ç–µ, —Å–∫–æ–ª—å–∫–æ —Ö–æ—Ç–∏—Ç–µ —ç–∫–æ–Ω–æ–º–∏—Ç—å –≤ –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ü–µ–ª–∏"}),m.length>0?e.jsxs("div",{children:[m.map(s=>{var a;if(!s||!s.id)return null;const n=(null==(a=f[t.id])?void 0:a[s.id])||0;return e.jsxs("div",{style:{marginBottom:"10px",display:"flex",gap:"10px",alignItems:"center"},children:[e.jsx("span",{style:{flex:1},children:s.name||"–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è"}),e.jsx("input",{type:"number",className:"form-input",style:{width:"150px",padding:"6px"},placeholder:"–°—É–º–º–∞ —ç–∫–æ–Ω–æ–º–∏–∏",value:n||"",onChange:e=>{const a=parseFloat(e.target.value)||0;N(e=>({...e,[t.id]:{...e[t.id]||{},[s.id]:a}}))},step:"1000",min:"0"})]},s.id)}),e.jsx("button",{onClick:async()=>{try{const e=f[t.id]||{};await a.saveGoal({...t,category_savings:e}),await S(),await w(t.id),alert("–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã")}catch(e){alert("–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏")}},className:"btn btn-primary",style:{marginTop:"10px",width:"100%"},children:"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏"})]}):e.jsx("p",{style:{fontSize:"0.85rem",color:"var(--text-secondary)"},children:"–°–æ–∑–¥–∞–π—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ"})]})]})]},t.id);var n})})}),r&&e.jsx("div",{className:"modal",style:{display:"flex"},onClick:e=>"modal"===e.target.className&&C(),children:e.jsxs("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h2",{children:c?"–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ü–µ–ª—å":"–ù–æ–≤–∞—è —Ü–µ–ª—å"}),e.jsx("button",{onClick:C,className:"modal-close",children:"√ó"})]}),e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),d.title&&d.target_amount)try{const e={...d,target_amount:parseFloat(d.target_amount),current_amount:(null==c?void 0:c.current_amount)||0,status:(null==c?void 0:c.status)||"active"};c&&(e.id=c.id),await a.saveGoal(e),await S(),C()}catch(t){alert("–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ —Ü–µ–ª–∏")}else alert("–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏ —Ü–µ–ª–µ–≤—É—é —Å—É–º–º—É")},className:"modal-body",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"–ù–∞–∑–≤–∞–Ω–∏–µ —Ü–µ–ª–∏"}),e.jsx("input",{type:"text",className:"form-input",value:d.title,onChange:e=>h({...d,title:e.target.value}),placeholder:"–ù–∞–ø—Ä–∏–º–µ—Ä: –ù–∞–∫–æ–ø–∏—Ç—å –Ω–∞ –æ—Ç–ø—É—Å–∫",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"–û–ø–∏—Å–∞–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)"}),e.jsx("textarea",{className:"form-input",value:d.description,onChange:e=>h({...d,description:e.target.value}),placeholder:"–ü–æ–¥—Ä–æ–±–Ω–µ–µ –æ —Ü–µ–ª–∏...",rows:3})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"–¶–µ–ª–µ–≤–∞—è —Å—É–º–º–∞ (—Å—É–º)"}),e.jsx("input",{type:"number",className:"form-input",value:d.target_amount,onChange:e=>h({...d,target_amount:e.target.value}),placeholder:"5000000",step:"1000",min:"0",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"–°—Ä–æ–∫ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)"}),e.jsx("input",{type:"date",className:"form-input",value:d.deadline,onChange:e=>h({...d,deadline:e.target.value})})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",onClick:C,className:"btn btn-secondary",children:"–û—Ç–º–µ–Ω–∞"}),e.jsx("button",{type:"submit",className:"btn btn-primary",children:c?"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å":"–°–æ–∑–¥–∞—Ç—å"})]})]})]})}),e.jsx(F,{})]})}function z({children:t}){const{user:s,loading:a}=T(),n=j(),i=b();return x.useEffect(()=>{(async()=>{if(a||s){if(s&&"/onboarding"!==i.pathname){const e=O();await e.hasCompletedOnboarding()||n("/onboarding")}}else n("/auth")})()},[s,a,n,i]),a?e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",color:"#6366f1"},children:"–ó–∞–≥—Ä—É–∑–∫–∞..."}):s?t:null}function U({children:e}){const{user:t}=T(),s=j();return x.useEffect(()=>{t&&s("/")},[t,s]),t?null:e}function J(){return e.jsxs(y,{children:[e.jsx(f,{path:"/auth",element:e.jsx(U,{children:e.jsx(A,{})})}),e.jsx(f,{path:"/onboarding",element:e.jsx(z,{children:e.jsx(R,{})})}),e.jsx(f,{path:"/",element:e.jsx(z,{children:e.jsx(q,{})})}),e.jsx(f,{path:"/analytics",element:e.jsx(z,{children:e.jsx(G,{})})}),e.jsx(f,{path:"/goals",element:e.jsx(z,{children:e.jsx(B,{})})}),e.jsx(f,{path:"*",element:e.jsx(N,{to:"/"})})]})}function Y(){return e.jsx(M,{children:e.jsx(J,{})})}t.register(s,a,n,i,r,l,c,o,d,h),C.createRoot(document.getElementById("root")).render(e.jsx(w.StrictMode,{children:e.jsx(S,{children:e.jsx(Y,{})})}));
